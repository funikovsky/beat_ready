!function(){const o=e=>{const t=e.find(".accordion__item"),a=e.find(".accordion__item--desc");t.removeClass("active"),a.width(0)},r=e=>{const t=e.find(".accordion__item--desc");var a,n=(e=>{let t=0;var a=$(".accordion").width();const n=e.closest(".accordion__items"),o=n.find(".accordion__item-title");o.width();var r=o.width()*o.length;const l=e.find(".accordion__item--desc--content");var i=parseInt(l.css("padding-left")),e=parseInt(l.css("padding-right"));return a-r<524?(t=a-r,console.log("isTablets")):t=524,{container:t,textContainer:t-i-e}})(e);const o=e.find(".accordion__item--desc--content");window.matchMedia("(max-width:480px)").matches?(a=$(".accordion").width()-parseInt(o.css("padding-left"))-parseInt(o.css("padding-right"))-$(".accordion__item").width(),t.width(n.container),o.width(a)):(t.width(n.container),o.width(n.textContainer)),e.addClass("active")};$(".accordion__item").on("click",e=>{const t=$(e.currentTarget),a=t.closest(".accordion__item");var n=a.hasClass("active"),e=t.closest(".accordion__items");n?o(e):(o(e),r(a))})}(),function(){const e=document.querySelector(".humburger"),t=document.querySelector(".fullscreen-menu"),a=document.querySelector(".fullscreen-menu__close");document.querySelector("body"),document.querySelector("active");const n=document.querySelectorAll(".menu--vertical .menu__link");document.querySelectorAll(".member__info");const s=document.querySelectorAll(".member__info-decor-symbol");document.querySelectorAll(".member__info-decor-symbol");const d=document.querySelectorAll(".member__desc");document.querySelectorAll(".member__desc--active");var o=document.querySelectorAll(".member");const m=document.querySelector(".member__desc-content"),u=document.querySelectorAll(".member__desc-text"),p=document.querySelector(".team__list--version--mobile");e.addEventListener("click",e=>{e.preventDefault(),t.classList.add("active")}),a.addEventListener("click",e=>{e.preventDefault(),t.classList.remove("active")}),n.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),t.classList.remove("active")})});for(let c of o)c.addEventListener("click",e=>{var t=getComputedStyle(c.lastElementChild).height,a=parseInt(t);const n=c.firstElementChild.nextElementSibling.lastElementChild.lastElementChild;var o,r,t=getComputedStyle(m).height;for(o of s)o.style.transform="rotate(0deg)";for(r of d)r.style.height="0px";if(0==a){if(c.lastElementChild.style.height=t,n.style.transform="rotate(180deg)","none"!=getComputedStyle(p).display){const i=c.firstChild.nextElementSibling.lastElementChild.firstElementChild;i.style.transform="rotate(180deg)"}for(var l of u)l.style.transform="rotate(0deg)"}else c.lastElementChild.style.height="0px"});const r=document.querySelector("#prev"),l=document.querySelector("#next"),i=document.querySelector("#products");window.getComputedStyle(i);var c=document.querySelectorAll(".product"),o=document.querySelector(".product");getComputedStyle(o).width;let v=0;const y=100*c.length;l.addEventListener("click",e=>{e.preventDefault(),v<y-100&&(v+=100,console.log(v),console.log(y),i.style.right=`${v}%`)}),r.addEventListener("click",e=>{e.preventDefault(),console.log(v),0<v&&(v-=100,i.style.right=`${v}%`)})}(),function(){let e;ymaps.ready(()=>{e=new ymaps.Map("map",{center:[59.938951,30.315635],zoom:12});const t=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"./img/marker.png",iconImageSize:[58,73],iconImageOffset:[-58,-73]});[[59.944859,30.224832],[59.930534,30.348935],[59.889354,30.36797]].forEach(e=>{t.add(new ymaps.Placemark(e))}),e.geoObjects.add(t),e.behaviors.disable("scrollZoom")})}(),$(".form").submit(e=>{e.preventDefault();const t=$(e.currentTarget),a=t.find("[name='name']"),n=t.find("[name='phone']"),o=t.find("[name='comment']"),r=t.find("[name='to']"),l=$("#modal"),i=l.find(".modal__content");e=t,[a,n,o,r].forEach(e=>{e.removeClass("input-error"),e.attr("placeholder",""),""==e.val().trim()&&(e.addClass("input-error"),e.attr("placeholder","Заполните это поле"))}),e=0==e.find(".input-error").length;if(l.removeClass("error-modal"),e){const c=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:a.val(),phone:n.val(),comment:o.val(),to:r.val()}});c.done(e=>{i.text(e.message),$(".form").trigger("reset")}),c.fail(e=>{i.text(e.responseJSON.message),l.addClass("error-modal")}),c.always(()=>{new Fancybox([{src:"#modal",type:"inline"}])})}}),$(".app-close-modal").click(e=>{e.preventDefault();Fancybox.close()}),function(){const n=$("section"),a=$(".maincontent"),o=$(".fixed-menu"),r=o.find(".fixed-menu__item"),e=new MobileDetect(window.navigator.userAgent);var t=e.mobile();let l=!1;n.first().addClass("active");const i=e=>{e*=-100;return isNaN(e)?(console.error("передано не верное значение в countSectionPosition"),0):e},c=e=>{const t=n.eq(e);e="fixed-menu--shadowed";"white"==t.attr("data-sidemenu-theme")?o.addClass(e):o.removeClass(e)},s=(e,t,a)=>{e.eq(t).addClass(a).siblings().removeClass(a)},d=e=>{var t;l||(l=!0,t=i(e),c(e),a.css({transform:`translateY(${t}%)`}),s(n,e,"active"),setTimeout(()=>{l=!1,s(r,e,"fixed-menu__item--active")},600))},m=()=>{const e=n.filter(".active"),t=e.next(),a=e.prev();return{next(){t.length&&d(t.index())},prev(){a.length&&d(a.index())}}};$(window).on("wheel",e=>{e=e.originalEvent.deltaY;const t=m();0<e&&t.next(),e<0&&t.prev()}),$(window).on("keydown",e=>{var t=e.target.tagName.toLowerCase(),t="input"==t||"textarea"==t;const a=m();if(!t)switch(e.keyCode){case 38:a.prev();break;case 40:a.next()}}),$(".wrapper").on("touchmove",e=>e.preventDefault()),$("[data-scroll-to]").click(e=>{e.preventDefault();const t=$(e.currentTarget);e=t.attr("data-scroll-to");const a=$(`[data-section-id = ${e}]`);d(a.index())}),t&&$("body").swipe({swipe:function(e,t){const a=m();let n="down"==t?"prev":"up"==t?"next":"";a[n]()}})}();let player;const playerContainer=$(".player");let eventsInint=()=>{$(".player__start").click(e=>{e.preventDefault(),playerContainer.hasClass("paused")?player.pauseVideo():player.playVideo()}),$(".player__playback").click(e=>{const t=$(e.currentTarget);var a=e.originalEvent.layerX/t.width()*100,e=player.getDuration()/100*a;$(".player__playback-button").css({left:`${a}%`}),player.seekTo(e)}),$(".player__splash").click(e=>{player.playVideo()})};const formatTime=e=>{var t=Math.round(e),e=a(Math.floor(t/60));function a(e){return e<10?`0${e}`:e}return`${e} : ${a(t-60*e)}`},onPlayerReady=()=>{let e;const a=player.getDuration();$(".player__duration-estimate").text(formatTime(a)),void 0!==e&&clearInterval(e),e=setInterval(()=>{var e=player.getCurrentTime(),t=e/a*100;$(".player__playback-button").css({left:`${t}%`}),$(".player__duration-completed").text(formatTime(e))},1e3)},onPlayerStateChange=e=>{switch(e.data){case 1:playerContainer.addClass("active"),playerContainer.addClass("paused");break;case 2:playerContainer.removeClass("active"),playerContainer.removeClass("paused")}};function onYouTubeIframeAPIReady(){player=new YT.Player("yt-player",{height:"100%",width:"100%",videoId:"7qBfdcI-d1Q",events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange},playerVars:{controls:0,disablekb:0,showinfo:0,rel:0,autoplay:0,modestbranding:0}})}eventsInint(),$(".interactive-avatar__link").click(e=>{e.preventDefault();const t=$(e.currentTarget);var a,e=t.attr("data-open");const n=(a=e,$(".reviews__item").filter((e,t)=>$(t).attr("data-linked-with")==a)),o=t.closest(".interactive-avatar");n.addClass("active").siblings().removeClass("active"),o.addClass("active").siblings().removeClass("active")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY29yZGlvbi5qcyIsIm1hcC5qcyIsIm1vZGFsLmpzIiwib3BzLmpzIiwicGxheWVyLmpzIiwic3dpdGhlci5qcyJdLCJuYW1lcyI6WyJjbG9zZUV2ZXJ5SXRlbUNvbnRhaW5lciIsImNvbnRhaW5lciIsIml0ZW1zIiwiZmluZCIsImNvbnRlbnQiLCJyZW1vdmVDbGFzcyIsIndpZHRoIiwib3Blbkl0ZW0iLCJpdGVtIiwiaGlkZGVuQ29udGVudCIsIm1vYmlsZURlc2NXaWR0aCIsInJlcVdpZHRoIiwicmVxSXRlbVdpZHRoIiwic2NyZWVuV2lkdGgiLCIkIiwiY2xvc2VzdCIsInRpdGxlc0Jsb2NrcyIsInRpdGxlc1dpZHRoIiwibGVuZ3RoIiwidGV4dENvbnRhaW5lciIsInBhZGRpbmdMZWZ0IiwicGFyc2VJbnQiLCJjc3MiLCJwYWRkaW5nUmlnaHQiLCJjb25zb2xlIiwibG9nIiwibWVzdXJlV2lkdGgiLCJ0ZXh0QmxvY2siLCJ3aW5kb3ciLCJtYXRjaE1lZGlhIiwibWF0Y2hlcyIsImFkZENsYXNzIiwib24iLCJlIiwiJHRoaXMiLCJjdXJyZW50VGFyZ2V0IiwiaXRlbU9wZW5lZCIsImhhc0NsYXNzIiwiYnVyZ2VyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZnVsbE1lbnUiLCJjbG9zZSIsIm1lbnVMaW5rIiwicXVlcnlTZWxlY3RvckFsbCIsIm1lbWJlckRlY29yIiwibWVtYmVyRGVzYyIsIm1lbWJlciIsIm1lbWJlckRlc2NDb250ZW50IiwibWVtYmVyRGVza1RleHQiLCJtb2JpbGVBY3RpdmUiLCJhZGRFdmVudExpc3RlbmVyIiwicHJldmVudERlZmF1bHQiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJmb3JFYWNoIiwiY3VycmVuSXRlbUhlaWdodCIsImdldENvbXB1dGVkU3R5bGUiLCJsYXN0RWxlbWVudENoaWxkIiwiaGVpZ2h0IiwiZmxhZyIsInRyaWFuZ2xlIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJzdmdJdGVtIiwiZGVzYyIsImZpeEhlaWdodCIsInN0eWxlIiwidHJhbnNmb3JtIiwiZGlzcGxheSIsInRyaWFuZ2xlVGFibGV0cyIsImZpcnN0Q2hpbGQiLCJlbGVtIiwicHJldkFycm93IiwibmV4dEFycm93IiwicHJvZHVjdHNMaXN0IiwicHJvZHVjdHMiLCJwcm9kdWN0IiwicG9zaXRpb24iLCJudW1iZXJQcm9kdWN0cyIsInJpZ2h0IiwibXlNYXAiLCJ5bWFwcyIsInJlYWR5IiwiTWFwIiwiY2VudGVyIiwiem9vbSIsIm15Q29sbGVjdGlvbiIsIkdlb09iamVjdENvbGxlY3Rpb24iLCJkcmFnZ2FibGUiLCJpY29uTGF5b3V0IiwiaWNvbkltYWdlSHJlZiIsImljb25JbWFnZVNpemUiLCJpY29uSW1hZ2VPZmZzZXQiLCJjb29yZCIsIlBsYWNlbWFyayIsImdlb09iamVjdHMiLCJiZWhhdmlvcnMiLCJkaXNhYmxlIiwic3VibWl0IiwiZm9ybSIsIm5hbWUiLCJwaG9uZSIsImNvbW1lbnQiLCJ0byIsIm1vZGFsIiwiZmllbGQiLCJhdHRyIiwidmFsIiwidHJpbSIsImlzVmFsaWQiLCJyZXF1ZXN0IiwiYWpheCIsInVybCIsIm1ldGhvZCIsImRhdGEiLCJkb25lIiwidGV4dCIsIm1lc3NhZ2UiLCJ0cmlnZ2VyIiwiZmFpbCIsInJlc3BvbnNlSlNPTiIsImFsd2F5cyIsIkZhbmN5Ym94Iiwic3JjIiwidHlwZSIsImNsaWNrIiwic2VjdGlvbnMiLCJzaWRlTWVudSIsIm1lbnVJdGVtcyIsIm1vYmlsZURldGVjdCIsIk1vYmlsZURldGVjdCIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsImlzTW9iaWxlIiwibW9iaWxlIiwiaW5TY3JvbGwiLCJmaXJzdCIsImNvdW50U2VjdGlvblBvc2l0aW9uIiwic2VjdGlvbkVxIiwiaXNOYU4iLCJlcnJvciIsImNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24iLCJjdXJyZW50U2VjdGlvbiIsImVxIiwiYWN0aXZlQ2xhc3MiLCJyZXNldEFjdGl2ZUNsYXNzRm9ySXRlbSIsIml0ZW1FcSIsInNpYmxpbmdzIiwicGVyZm9tVHJhbnNpdGlvbiIsInNldFRpbWVvdXQiLCJ0cmFuc2lzdGlvbk92ZXIiLCJ2aWV3cG9ydFNjcm9sbGVyIiwiYWN0aXZlU2VjdGlvbiIsImZpbHRlciIsIm5leHRTZWN0aW9uIiwibmV4dCIsInByZXZTZWN0aW9uIiwicHJldiIsImluZGV4IiwiZGVsdGFZIiwib3JpZ2luYWxFdmVudCIsInNjcm9sbGVyIiwidGFnTmFtZSIsInRhcmdldCIsInRvTG93ZXJDYXNlIiwidXNlclRheXBpbmdJbklucHV0cyIsImtleUNvZGUiLCJyZXFTZWN0aW9uIiwic3dpcGUiLCJldmVudCIsImRpcmVjdGlvbiIsInNjcm9sbERpcmVjdGlvbiIsInBsYXllciIsInBsYXllckNvbnRhaW5lciIsImV2ZW50c0luaW50IiwicGF1c2VWaWRlbyIsInBsYXlWaWRlbyIsImJhciIsIm5ld0J1dHRvblBvc2l0aW9uUGVyY2VudCIsImxheWVyWCIsIm5ld1BsYXliYWNrUG9zaXN0aW9uU2VjIiwiZ2V0RHVyYXRpb24iLCJsZWZ0Iiwic2Vla1RvIiwiZm9ybWF0VGltZSIsInRpbWVTZWMiLCJyb3VuZFRpbWUiLCJNYXRoIiwicm91bmQiLCJtaW51dGVzIiwiYWRkWmVybyIsImZsb29yIiwibnVtIiwib25QbGF5ZXJSZWFkeSIsImludGVydmFsIiwiZHVyYXRpb25TZWMiLCJjbGVhckludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJjb21wbGV0ZWRTZWMiLCJnZXRDdXJyZW50VGltZSIsImNvbXBsZXRlZFBlcmNlbnQiLCJvblBsYXllclN0YXRlQ2hhbmdlIiwib25Zb3VUdWJlSWZyYW1lQVBJUmVhZHkiLCJZVCIsIlBsYXllciIsInZpZGVvSWQiLCJldmVudHMiLCJvblJlYWR5Iiwib25TdGF0ZUNoYW5nZSIsInBsYXllclZhcnMiLCJjb250cm9scyIsImRpc2FibGVrYiIsInNob3dpbmZvIiwicmVsIiwiYXV0b3BsYXkiLCJtb2Rlc3RicmFuZGluZyIsIml0ZW1Ub1No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QSxPQUNBdEQsTUFBQSxPQUNBeU0sUUFBQSxjQUNBQyxPQUFBLENBQ0FDLFFBQUFkLGNBQ0FlLGNBQUFQLHFCQUVBUSxXQUFBLENBQ0FDLFNBQUEsRUFDQUMsVUFBQSxFQUNBQyxTQUFBLEVBQ0FDLElBQUEsRUFDQUMsU0FBQSxFQUNBQyxlQUFBLEtBS0F6QyxjQ3RIQWxLLEVBQUEsNkJBQUFpSCxNQUFBOUYsSUFDQUEsRUFBQW1CLGlCQUVBLE1BQUFsQixFQUFBcEIsRUFBQW1CLEVBQUFFLGVBQ0EsSUFYQSxFQVdBa0ksRUFBQW5JLEVBQUEwRSxLQUFBLGFBQ0EsTUFBQThHLEdBWkEsRUFZQXJELEVBWEF2SixFQUFBLGtCQUFBNkksT0FBQSxDQUFBZ0UsRUFBQW5OLElBQ0FNLEVBQUFOLEdBQUFvRyxLQUFBLHFCQUFBZ0gsSUFXQUMsRUFBQTNMLEVBQUFuQixRQUFBLHVCQUdBMk0sRUFBQTNMLFNBQUEsVUFBQXNILFdBQUFoSixZQUFBLFVBQ0F3TixFQUFBOUwsU0FBQSxVQUFBc0gsV0FBQWhKLFlBQUEiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG47KGZ1bmN0aW9uKCl7XHJcbmNvbnN0IG1lc3VyZVdpZHRoID0gaXRlbSA9PiB7XHJcblxyXG4gICAgbGV0IHJlcUl0ZW1XaWR0aCA9IDA7XHJcblxyXG4gICAgY29uc3Qgc2NyZWVuV2lkdGggPSAkKFwiLmFjY29yZGlvblwiKS53aWR0aCgpO1xyXG4gICAgY29uc3QgY29udGFpbmVyID0gaXRlbS5jbG9zZXN0KFwiLmFjY29yZGlvbl9faXRlbXNcIik7XHJcbiAgICBjb25zdCB0aXRsZXNCbG9ja3MgPSBjb250YWluZXIuZmluZChcIi5hY2NvcmRpb25fX2l0ZW0tdGl0bGVcIik7XHJcbiAgICBjb25zdCB0aXRsZXNCbG9jayA9IHRpdGxlc0Jsb2Nrcy53aWR0aCgpXHJcbiAgICBjb25zdCB0aXRsZXNXaWR0aCA9IHRpdGxlc0Jsb2Nrcy53aWR0aCgpKnRpdGxlc0Jsb2Nrcy5sZW5ndGg7XHJcblxyXG5cclxuICAgIGNvbnN0IHRleHRDb250YWluZXIgPSBpdGVtLmZpbmQoXCIuYWNjb3JkaW9uX19pdGVtLS1kZXNjLS1jb250ZW50XCIpO1xyXG4gICAgY29uc3QgcGFkZGluZ0xlZnQgPSBwYXJzZUludCh0ZXh0Q29udGFpbmVyLmNzcyhcInBhZGRpbmctbGVmdFwiKSk7XHJcbiAgICBjb25zdCBwYWRkaW5nUmlnaHQgPSBwYXJzZUludCh0ZXh0Q29udGFpbmVyLmNzcyhcInBhZGRpbmctcmlnaHRcIikpO1xyXG4gICAgY29uc3QgbWF4V2lkdGggPSBzY3JlZW5XaWR0aCAtIHRpdGxlc1dpZHRoXHJcblxyXG5cclxuXHJcbiAgICAvL2NvbnN0IGlzVGFibGV0cyA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDo3NjhweClcIikubWF0Y2hlcztcclxuICAgIFxyXG5cclxuICAgaWYobWF4V2lkdGg8NTI0KSB7XHJcblxyXG5cclxuICAgICAgICByZXFJdGVtV2lkdGggPSBzY3JlZW5XaWR0aCAtIHRpdGxlc1dpZHRoO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiaXNUYWJsZXRzXCIpXHJcblxyXG5cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVxSXRlbVdpZHRoID0gNTI0O1xyXG4gICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICByZXR1cm4gIHtcclxuICAgICAgICBcclxuICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnRhaW5lcjogcmVxSXRlbVdpZHRoLFxyXG4gICAgICAgIHRleHRDb250YWluZXI6IHJlcUl0ZW1XaWR0aCAtIHBhZGRpbmdMZWZ0IC1wYWRkaW5nUmlnaHRcclxuICAgIFxyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgXHJcbn1cclxuXHJcbmNvbnN0IGNsb3NlRXZlcnlJdGVtQ29udGFpbmVyID0gY29udGFpbmVyID0+IHtcclxuICAgIGNvbnN0IGl0ZW1zID0gY29udGFpbmVyLmZpbmQoXCIuYWNjb3JkaW9uX19pdGVtXCIpXHJcbiAgICBjb25zdCBjb250ZW50ID0gY29udGFpbmVyLmZpbmQoXCIuYWNjb3JkaW9uX19pdGVtLS1kZXNjXCIpXHJcbiAgICBcclxuXHJcbiAgICBpdGVtcy5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKVxyXG4gICAgY29udGVudC53aWR0aCgwKTtcclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxufVxyXG5cclxuY29uc3Qgb3Blbkl0ZW0gPSBpdGVtID0+IHtcclxuICAgIGNvbnN0IGhpZGRlbkNvbnRlbnQgPSBpdGVtLmZpbmQoXCIuYWNjb3JkaW9uX19pdGVtLS1kZXNjXCIpO1xyXG4gICAgY29uc3QgcmVxV2lkdGggPSBtZXN1cmVXaWR0aChpdGVtKTtcclxuICAgIGNvbnN0IHRleHRCbG9jayA9IGl0ZW0uZmluZChcIi5hY2NvcmRpb25fX2l0ZW0tLWRlc2MtLWNvbnRlbnRcIik7XHJcbiAgICBjb25zdCBpc01vYmlsZSA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDo0ODBweClcIikubWF0Y2hlcztcclxuICAgIFxyXG4gICBcclxuXHJcbiAgICBpZihpc01vYmlsZSkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGFjY29yZGlvbldpZHRoID0gJChcIi5hY2NvcmRpb25cIikud2lkdGgoKTtcclxuXHJcbiAgICAgICAgY29uc3QgRGVzY1BhZGRpbmdMZWZ0ID0gcGFyc2VJbnQodGV4dEJsb2NrLmNzcyhcInBhZGRpbmctbGVmdFwiKSk7XHJcbiAgICAgICAgY29uc3QgRGVzY1BhZGRpbmdSaWdodCA9IHBhcnNlSW50KHRleHRCbG9jay5jc3MoXCJwYWRkaW5nLXJpZ2h0XCIpKTtcclxuICAgICAgICBjb25zdCBhY2NvcmRpb25JdGVtV2lkdGggPSAkKFwiLmFjY29yZGlvbl9faXRlbVwiKS53aWR0aCgpO1xyXG4gICAgICAgIGNvbnN0IG1vYmlsZURlc2NXaWR0aCA9IGFjY29yZGlvbldpZHRoIC0gRGVzY1BhZGRpbmdMZWZ0IC0gRGVzY1BhZGRpbmdSaWdodCAtIGFjY29yZGlvbkl0ZW1XaWR0aDtcclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgaGlkZGVuQ29udGVudC53aWR0aChyZXFXaWR0aC5jb250YWluZXIpO1xyXG4gICAgICAgIHRleHRCbG9jay53aWR0aChtb2JpbGVEZXNjV2lkdGgpO1xyXG4gICAgICAgIGl0ZW0uYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcblxyXG4gICAgfWVsc2Uge1xyXG5cclxuICAgICAgICBoaWRkZW5Db250ZW50LndpZHRoKHJlcVdpZHRoLmNvbnRhaW5lcik7XHJcbiAgICAgICAgdGV4dEJsb2NrLndpZHRoKHJlcVdpZHRoLnRleHRDb250YWluZXIpO1xyXG4gICAgICAgIGl0ZW0uYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcblxyXG5cclxuICAgIH1cclxuICAgIFxyXG5cclxuXHJcblxyXG5cclxufVxyXG5cclxuJChcIi5hY2NvcmRpb25fX2l0ZW1cIikub24oXCJjbGlja1wiLCBlID0+IHtcclxuXHJcbiAgICAvL2NvbnN0IGlzTW9iaWxlID0gd2luZG93Lm1hdGNoTWVkaWEoXCIobWF4LXdpZHRoOjc2OHB4KVwiKS5tYXRjaGVzO1xyXG4gICBcclxuICAgIFxyXG4gICAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XHJcbiAgICBjb25zdCBpdGVtID0gJHRoaXMuY2xvc2VzdChcIi5hY2NvcmRpb25fX2l0ZW1cIilcclxuICAgIGNvbnN0IGl0ZW1PcGVuZWQgPSBpdGVtLmhhc0NsYXNzKFwiYWN0aXZlXCIpXHJcbiAgICBjb25zdCBjb250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLmFjY29yZGlvbl9faXRlbXNcIilcclxuXHJcbiAgICAvL2NvbnN0IGl0ZW1zID0gY29udGFpbmVyLmZpbmQoXCIuYWNjb3JkaW9uX19pdGVtXCIpXHJcbiAgICBcclxuXHJcbiAgICBpZiAoaXRlbU9wZW5lZCkge1xyXG4gICAgICAgIGNsb3NlRXZlcnlJdGVtQ29udGFpbmVyKGNvbnRhaW5lcilcclxuICAgICAgICBcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY2xvc2VFdmVyeUl0ZW1Db250YWluZXIoY29udGFpbmVyKVxyXG4gICAgICAgIG9wZW5JdGVtKGl0ZW0pO1xyXG4gICAgfVxyXG5cclxuICAgIFxyXG5cclxuICAgXHJcbn0pO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vKlxyXG5cclxuY29uc3QgYWNjb3JkaW9uSXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYWNjb3JkaW9uX19pdGVtXCIpXHJcbmZvcihsZXQgaXRlbSBvZiBhY2NvcmRpb25JdGVtKSB7XHJcbiAgICAgICBcclxuICAgIFxyXG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xyXG5cclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBkZXNjV2lkdGggPSBnZXRDb21wdXRlZFN0eWxlKGl0ZW0ubGFzdEVsZW1lbnRDaGlsZCkud2lkdGhcclxuICAgICAgICBjb25zdCBjdXJyZW50ZGVzY1dpZHRoID0gcGFyc2VJbnQoZGVzY1dpZHRoKTtcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coY3VycmVudGRlc2NXaWR0aClcclxuICAgICAgICBpZihjdXJyZW50ZGVzY1dpZHRoID09IDApIHtcclxuICAgICAgICAgICAgZm9yKGxldCBlbGVtZW50IG9mIGFjY29yZGlvbkl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIilcclxuXHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9KVxyXG59XHJcblxyXG4qL1xyXG5cclxufSkoKSIsIjsoZnVuY3Rpb24oKXtcclxuXHJcbmxldCBteU1hcDtcclxuXHJcbmNvbnN0IGluaXQgPSAoKSA9PiB7XHJcblxyXG4gICAgbXlNYXAgPSBuZXcgeW1hcHMuTWFwKFwibWFwXCIsIHtcclxuXHJcbiAgICAgICAgY2VudGVyOiBbNTkuOTM4OTUxLCAzMC4zMTU2MzVdLFxyXG4gICAgICAgIHpvb206IDEyLFxyXG4gICAgICAgIFxyXG5cclxuXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBjb29yZHMgPSBbXHJcblxyXG4gICAgICAgIFs1OS45NDQ4NTksIDMwLjIyNDgzMl0sXHJcbiAgICAgICAgWzU5LjkzMDUzNCwzMC4zNDg5MzVdLFxyXG4gICAgICAgIFs1OS44ODkzNTQsMzAuMzY3OTcwXVxyXG5cclxuXHJcblxyXG4gICAgXTtcclxuXHJcbiAgICBjb25zdCBteUNvbGxlY3Rpb24gPSBuZXcgeW1hcHMuR2VvT2JqZWN0Q29sbGVjdGlvbih7fSwge1xyXG5cclxuICAgICAgICBkcmFnZ2FibGU6IGZhbHNlLFxyXG4gICAgICAgIGljb25MYXlvdXQ6ICdkZWZhdWx0I2ltYWdlJyxcclxuICAgICAgIFxyXG4gICAgICAgIGljb25JbWFnZUhyZWY6ICcuL2ltZy9tYXJrZXIucG5nJyxcclxuICAgICAgICBpY29uSW1hZ2VTaXplOiBbNTgsIDczXSxcclxuICAgICAgICBpY29uSW1hZ2VPZmZzZXQ6IFstNTgsIC03M11cclxuXHJcbiAgICB9ICk7XHJcblxyXG4gICAgY29vcmRzLmZvckVhY2goY29vcmQgPT4ge1xyXG4gICAgICAgIG15Q29sbGVjdGlvbi5hZGQobmV3IHltYXBzLlBsYWNlbWFyayhjb29yZCkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgbXlNYXAuZ2VvT2JqZWN0cy5hZGQobXlDb2xsZWN0aW9uKTtcclxuICAgIG15TWFwLmJlaGF2aW9ycy5kaXNhYmxlKCdzY3JvbGxab29tJyk7XHJcbiAgICBcclxuXHJcblxyXG59XHJcblxyXG55bWFwcy5yZWFkeShpbml0KTtcclxuXHJcblxyXG59KSgpIiwiOyhmdW5jdGlvbigpe1xyXG5cclxuY29uc3QgdmFsaWRhdGVGaWVsZHMgPSAoZm9ybSwgZmllbGRzQXJyYXkpID0+IHtcclxuXHJcbiAgICBmaWVsZHNBcnJheS5mb3JFYWNoKGZpZWxkID0+IHtcclxuXHJcbiAgICAgICAgZmllbGQucmVtb3ZlQ2xhc3MoXCJpbnB1dC1lcnJvclwiKVxyXG4gICAgICAgIGZpZWxkLmF0dHIoJ3BsYWNlaG9sZGVyJywgJycpO1xyXG5cclxuICAgICAgICBpZihmaWVsZC52YWwoKS50cmltKCkgPT0gXCJcIikge1xyXG4gICAgICAgICAgICBmaWVsZC5hZGRDbGFzcyhcImlucHV0LWVycm9yXCIpO1xyXG4gICAgICAgICAgICBmaWVsZC5hdHRyKCdwbGFjZWhvbGRlcicsICfQl9Cw0L/QvtC70L3QuNGC0LUg0Y3RgtC+INC/0L7Qu9C1Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IGVycm9yc0ZpZWxkcyA9IGZvcm0uZmluZChcIi5pbnB1dC1lcnJvclwiKTtcclxuXHJcbiAgICByZXR1cm4gZXJyb3JzRmllbGRzLmxlbmd0aCA9PSAwO1xyXG5cclxuXHJcblxyXG59XHJcblxyXG5cclxuXHJcbiQoJy5mb3JtJykuc3VibWl0KGUgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgXHJcbiAgICBjb25zdCBmb3JtID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgY29uc3QgbmFtZSA9IGZvcm0uZmluZChcIltuYW1lPSduYW1lJ11cIik7XHJcbiAgICBjb25zdCBwaG9uZSA9IGZvcm0uZmluZChcIltuYW1lPSdwaG9uZSddXCIpO1xyXG4gICAgY29uc3QgY29tbWVudCA9IGZvcm0uZmluZChcIltuYW1lPSdjb21tZW50J11cIik7XHJcbiAgICBjb25zdCB0byA9IGZvcm0uZmluZChcIltuYW1lPSd0byddXCIpO1xyXG5cclxuICAgXHJcblxyXG4gICAgXHJcbiAgICBcclxuXHJcbiAgICBjb25zdCBtb2RhbCA9ICQoXCIjbW9kYWxcIik7XHJcbiAgICBjb25zdCBjb250ZW50ID0gbW9kYWwuZmluZChcIi5tb2RhbF9fY29udGVudFwiKTsgXHJcblxyXG5cclxuICAgIGNvbnN0IGlzVmFsaWQgPSB2YWxpZGF0ZUZpZWxkcyhmb3JtLCBbbmFtZSwgcGhvbmUsIGNvbW1lbnQsIHRvXSk7XHJcblxyXG4gICAgbW9kYWwucmVtb3ZlQ2xhc3MoXCJlcnJvci1tb2RhbFwiKVxyXG5cclxuXHJcbiAgICBcclxuICAgIGlmKGlzVmFsaWQpIHtcclxuICAgICAgICBjb25zdCByZXF1ZXN0ID0gJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiBcImh0dHBzOi8vd2ViZGV2LWFwaS5sb2Z0c2Nob29sLmNvbS9zZW5kbWFpbFwiLFxyXG4gICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgcGhvbmU6IHBob25lLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgY29tbWVudDogY29tbWVudC52YWwoKSxcclxuICAgICAgICAgICAgICAgIHRvOiB0by52YWwoKSxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXF1ZXN0LmRvbmUoKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgY29udGVudC50ZXh0KGRhdGEubWVzc2FnZSlcclxuICAgICAgICAgICAgJCgnLmZvcm0nKS50cmlnZ2VyKFwicmVzZXRcIik7XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXF1ZXN0LmZhaWwoKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgY29udGVudC50ZXh0KGRhdGEucmVzcG9uc2VKU09OLm1lc3NhZ2UpXHJcbiAgICAgICAgICAgIG1vZGFsLmFkZENsYXNzKFwiZXJyb3ItbW9kYWxcIilcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmVxdWVzdC5hbHdheXMoKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBmYW5jeWJveCA9IG5ldyBGYW5jeWJveChbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3JjOiBcIiNtb2RhbFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiaW5saW5lXCIsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59KTtcclxuXHJcblxyXG4kKCcuYXBwLWNsb3NlLW1vZGFsJykuY2xpY2soKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnN0IGZhbmN5Ym94ID0gRmFuY3lib3guY2xvc2UoKTtcclxuICAgIFxyXG59KTtcclxuXHJcbn0pKCkiLCI7KGZ1bmN0aW9uKCl7XHJcblxyXG5jb25zdCBzZWN0aW9ucyA9ICQoXCJzZWN0aW9uXCIpO1xyXG5jb25zdCBkaXNwbGF5ID0gJChcIi5tYWluY29udGVudFwiKTtcclxuY29uc3Qgc2lkZU1lbnUgPSAkKFwiLmZpeGVkLW1lbnVcIik7XHJcbmNvbnN0IG1lbnVJdGVtcyA9IHNpZGVNZW51LmZpbmQoXCIuZml4ZWQtbWVudV9faXRlbVwiKTtcclxuXHJcbmNvbnN0IG1vYmlsZURldGVjdCA9IG5ldyBNb2JpbGVEZXRlY3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG5jb25zdCBpc01vYmlsZSA9IG1vYmlsZURldGVjdC5tb2JpbGUoKTtcclxuXHJcblxyXG5sZXQgaW5TY3JvbGwgPSBmYWxzZTtcclxuXHJcbnNlY3Rpb25zLmZpcnN0KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcblxyXG5jb25zdCBjb3VudFNlY3Rpb25Qb3NpdGlvbiA9IHNlY3Rpb25FcSA9PiB7XHJcbiAgICBcclxuICAgIGNvbnN0IHBvc2l0aW9uID0gc2VjdGlvbkVxKiAtMTAwO1xyXG4gICAgXHJcbiAgICBpZihpc05hTihwb3NpdGlvbikpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwi0L/QtdGA0LXQtNCw0L3QviDQvdC1INCy0LXRgNC90L7QtSDQt9C90LDRh9C10L3QuNC1INCyIGNvdW50U2VjdGlvblBvc2l0aW9uXCIpXHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHBvc2l0aW9uO1xyXG59XHJcblxyXG5jb25zdCBjaGFuZ2VNZW51VGhlbWVGb3JTZWN0aW9uID0gKHNlY3Rpb25FcSkgPT4ge1xyXG5cclxuICAgIGNvbnN0IGN1cnJlbnRTZWN0aW9uID0gc2VjdGlvbnMuZXEoc2VjdGlvbkVxKTtcclxuICAgIGNvbnN0IG1lbnVUaGVtZSA9IGN1cnJlbnRTZWN0aW9uLmF0dHIoXCJkYXRhLXNpZGVtZW51LXRoZW1lXCIpXHJcbiAgICBjb25zdCBhY3RpdmVDbGFzcyA9IFwiZml4ZWQtbWVudS0tc2hhZG93ZWRcIjtcclxuICAgIFxyXG5cclxuICAgIGlmKG1lbnVUaGVtZSA9PSBcIndoaXRlXCIpIHtcclxuICAgICAgICBzaWRlTWVudS5hZGRDbGFzcyhhY3RpdmVDbGFzcyk7XHJcbiAgICB9ZWxzZSB7XHJcbiAgICAgICAgc2lkZU1lbnUucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG4gICAgfVxyXG5cclxufTtcclxuXHJcbmNvbnN0IHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtID0gKGl0ZW1zLCBpdGVtRXEsIGFjdGl2ZUNsYXNzKSA9PiB7XHJcbiAgICBpdGVtcy5lcShpdGVtRXEpLmFkZENsYXNzKGFjdGl2ZUNsYXNzKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKGFjdGl2ZUNsYXNzKTtcclxufVxyXG5cclxuXHJcblxyXG5jb25zdCBwZXJmb21UcmFuc2l0aW9uID0gc2VjdGlvbkVxID0+IHtcclxuXHJcbiAgICBpZihpblNjcm9sbCkgcmV0dXJuXHJcblxyXG4gICAgY29uc3QgdHJhbnNpc3Rpb25PdmVyID0gNTAwO1xyXG4gICAgY29uc3QgbW91c2VJbmVydGlhT3ZlciA9IDEwMDtcclxuXHJcbiAgICBpblNjcm9sbCA9IHRydWU7XHJcbiAgICBcclxuICAgIGNvbnN0IHBvc2l0aW9uID0gY291bnRTZWN0aW9uUG9zaXRpb24oc2VjdGlvbkVxKTtcclxuXHJcbiAgICBjaGFuZ2VNZW51VGhlbWVGb3JTZWN0aW9uKHNlY3Rpb25FcSk7XHJcblxyXG4gICAgZGlzcGxheS5jc3Moe1xyXG4gICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgke3Bvc2l0aW9ufSUpYFxyXG5cclxuICAgIH0pO1xyXG5cclxuICAgIHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtKHNlY3Rpb25zLCBzZWN0aW9uRXEsIFwiYWN0aXZlXCIpO1xyXG5cclxuXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBpblNjcm9sbCA9IGZhbHNlO1xyXG4gICAgICAgIHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtKG1lbnVJdGVtcywgc2VjdGlvbkVxLCBcImZpeGVkLW1lbnVfX2l0ZW0tLWFjdGl2ZVwiKVxyXG4gICAgfSwgdHJhbnNpc3Rpb25PdmVyICsgbW91c2VJbmVydGlhT3Zlcik7XHJcblxyXG59XHJcblxyXG5jb25zdCB2aWV3cG9ydFNjcm9sbGVyID0gKCkgPT4ge1xyXG5cclxuICAgIGNvbnN0IGFjdGl2ZVNlY3Rpb24gPSBzZWN0aW9ucy5maWx0ZXIoXCIuYWN0aXZlXCIpXHJcbiAgICBjb25zdCBuZXh0U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ubmV4dCgpO1xyXG4gICAgY29uc3QgcHJldlNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLnByZXYoKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQoKSB7XHJcbiAgICAgICAgICAgIGlmKG5leHRTZWN0aW9uLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcGVyZm9tVHJhbnNpdGlvbihuZXh0U2VjdGlvbi5pbmRleCgpKVxyXG4gICAgICAgIFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHByZXYoKSB7XHJcbiAgICAgICAgICAgIGlmKHByZXZTZWN0aW9uLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcGVyZm9tVHJhbnNpdGlvbihwcmV2U2VjdGlvbi5pbmRleCgpKVxyXG4gICAgICAgIFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgXHJcbiAgICBcclxufVxyXG5cclxuJCh3aW5kb3cpLm9uKFwid2hlZWxcIiwgZSA9PiB7XHJcblxyXG4gICAgXHJcblxyXG4gICAgY29uc3QgZGVsdGFZID0gZS5vcmlnaW5hbEV2ZW50LmRlbHRhWTtcclxuICAgIGNvbnN0IHNjcm9sbGVyID0gdmlld3BvcnRTY3JvbGxlcigpO1xyXG5cclxuXHJcbiAgICBpZihkZWx0YVkgPiAwKSB7XHJcbiAgICAgICAgc2Nyb2xsZXIubmV4dCgpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG4gICAgaWYoZGVsdGFZIDwgMCkge1xyXG4gICAgICAgIHNjcm9sbGVyLnByZXYoKTtcclxuICAgICAgIFxyXG4gICAgfVxyXG4gICAgXHJcbn0pXHJcblxyXG4kKHdpbmRvdykub24oXCJrZXlkb3duXCIsIGUgPT4ge1xyXG5cclxuICAgIGNvbnN0IHRhZ05hbWUgPSBlLnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBjb25zdCB1c2VyVGF5cGluZ0luSW5wdXRzID0gdGFnTmFtZSA9PSBcImlucHV0XCIgfHwgdGFnTmFtZSA9PSBcInRleHRhcmVhXCJcclxuICAgIGNvbnN0IHNjcm9sbGVyID0gdmlld3BvcnRTY3JvbGxlcigpO1xyXG5cclxuICAgIGlmKHVzZXJUYXlwaW5nSW5JbnB1dHMpIHJldHVybjsgXHJcblxyXG4gICAgc3dpdGNoIChlLmtleUNvZGUpIHtcclxuICAgICAgICBjYXNlIDM4OlxyXG4gICAgICAgICAgICBzY3JvbGxlci5wcmV2KCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgXHJcbiAgICAgICAgY2FzZSA0MDpcclxuICAgICAgICAgICAgc2Nyb2xsZXIubmV4dCgpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgIH1cclxuXHJcblxyXG4gICAgXHJcbn0pO1xyXG5cclxuJChcIi53cmFwcGVyXCIpLm9uKFwidG91Y2htb3ZlXCIsIGUgPT4gZS5wcmV2ZW50RGVmYXVsdCgpKTtcclxuXHJcbiQoXCJbZGF0YS1zY3JvbGwtdG9dXCIpLmNsaWNrKGUgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgY29uc3QgdGFyZ2V0ID0gJHRoaXMuYXR0cihcImRhdGEtc2Nyb2xsLXRvXCIpO1xyXG4gICAgY29uc3QgcmVxU2VjdGlvbiA9ICQoYFtkYXRhLXNlY3Rpb24taWQgPSAke3RhcmdldH1dYCk7XHJcblxyXG4gICAgcGVyZm9tVHJhbnNpdGlvbihyZXFTZWN0aW9uLmluZGV4KCkpXHJcblxyXG4gICAgXHJcbn0pXHJcblxyXG5cclxuLy9odHRwczovL2dpdGh1Yi5jb20vbWF0dGJyeXNvbi9Ub3VjaFN3aXBlLUpxdWVyeS1QbHVnaW5cclxuXHJcbmlmKGlzTW9iaWxlKSB7XHJcbiAgICAkKFwiYm9keVwiKS5zd2lwZSh7XHJcbiAgICAgICAgc3dpcGU6ZnVuY3Rpb24oXHJcbiAgICAgICAgICAgIGV2ZW50LFxyXG4gICAgICAgICAgICBkaXJlY3Rpb24sXHJcbiAgICAgICAgKSB7XHJcbiAgICBcclxuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyKCk7XHJcbiAgICAgICAgICAgIGxldCBzY3JvbGxEaXJlY3Rpb24gPSBcIlwiO1xyXG4gICAgICAgICAgICBpZihkaXJlY3Rpb24gPT0gXCJ1cFwiKSBzY3JvbGxEaXJlY3Rpb24gPSBcIm5leHRcIjtcclxuICAgICAgICAgICAgaWYoZGlyZWN0aW9uID09IFwiZG93blwiKSBzY3JvbGxEaXJlY3Rpb24gPSBcInByZXZcIjtcclxuICAgIFxyXG4gICAgICAgICAgICBzY3JvbGxlcltzY3JvbGxEaXJlY3Rpb25dKCk7XHJcbiAgICBcclxuICAgICAgICAgIFxyXG4gICAgXHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgfSk7XHJcbiAgICBcclxuXHJcblxyXG5cclxufVxyXG5cclxufSkoKVxyXG5cclxuIiwiXHJcblxyXG5cclxubGV0IHBsYXllcjtcclxuY29uc3QgcGxheWVyQ29udGFpbmVyID0gJChcIi5wbGF5ZXJcIik7XHJcblxyXG5sZXQgZXZlbnRzSW5pbnQgPSAoKSA9PiB7XHJcbiAgICAkKFwiLnBsYXllcl9fc3RhcnRcIikuY2xpY2soZT0+IHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIGlmKHBsYXllckNvbnRhaW5lci5oYXNDbGFzcyhcInBhdXNlZFwiKSApIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcGxheWVyLnBhdXNlVmlkZW8oKVxyXG5cclxuICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcGxheWVyLnBsYXlWaWRlbygpXHJcbiAgICAgICAgICAgIFxyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuXHJcbiAgICAkKFwiLnBsYXllcl9fcGxheWJhY2tcIikuY2xpY2soZSA9PiB7XHJcbiAgICAgICAgY29uc3QgYmFyID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgICAgIGNvbnN0IGNsaWNrZWRQb3Npc3Rpb24gPSBlLm9yaWdpbmFsRXZlbnQubGF5ZXJYO1xyXG4gICAgICAgIGNvbnN0IG5ld0J1dHRvblBvc2l0aW9uUGVyY2VudCA9IChjbGlja2VkUG9zaXN0aW9uL2Jhci53aWR0aCgpKSoxMDA7XHJcbiAgICAgICAgY29uc3QgbmV3UGxheWJhY2tQb3Npc3Rpb25TZWMgPSAocGxheWVyLmdldER1cmF0aW9uKCkvMTAwKSpuZXdCdXR0b25Qb3NpdGlvblBlcmNlbnQ7XHJcbiAgICAgICAgXHJcbiAgICAgICAgJChcIi5wbGF5ZXJfX3BsYXliYWNrLWJ1dHRvblwiKS5jc3MgKHtcclxuICAgICAgICAgICAgbGVmdDogYCR7bmV3QnV0dG9uUG9zaXRpb25QZXJjZW50fSVgXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHBsYXllci5zZWVrVG8obmV3UGxheWJhY2tQb3Npc3Rpb25TZWMpO1xyXG5cclxuICAgICAgICBcclxuICAgIH0pO1xyXG4gICAgJChcIi5wbGF5ZXJfX3NwbGFzaFwiKS5jbGljayAoZSA9PiB7XHJcbiAgICAgICAgcGxheWVyLnBsYXlWaWRlbygpO1xyXG4gICAgfSkgXHJcblxyXG59XHJcblxyXG5jb25zdCBmb3JtYXRUaW1lID0gdGltZVNlYyA9PiB7XHJcbiAgICBjb25zdCByb3VuZFRpbWUgPSBNYXRoLnJvdW5kKHRpbWVTZWMpO1xyXG5cclxuICAgIGNvbnN0IG1pbnV0ZXMgPSBhZGRaZXJvKE1hdGguZmxvb3Iocm91bmRUaW1lLzYwKSk7XHJcbiAgICBjb25zdCBzZWNvbmRzID0gYWRkWmVybyhyb3VuZFRpbWUgLSBtaW51dGVzKjYwKTtcclxuXHJcbiAgICBmdW5jdGlvbiBhZGRaZXJvKG51bSkge1xyXG4gICAgICAgIHJldHVybiBudW0gPCAxMCA/IGAwJHtudW19YCA6IG51bTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gYCR7bWludXRlc30gOiAke3NlY29uZHN9YDtcclxufVxyXG5cclxuY29uc3Qgb25QbGF5ZXJSZWFkeSA9ICgpID0+IHtcclxuXHJcbiAgICBsZXQgaW50ZXJ2YWw7XHJcblxyXG4gICAgY29uc3QgZHVyYXRpb25TZWMgPSBwbGF5ZXIuZ2V0RHVyYXRpb24oKTtcclxuICAgICQoXCIucGxheWVyX19kdXJhdGlvbi1lc3RpbWF0ZVwiKS50ZXh0KGZvcm1hdFRpbWUoZHVyYXRpb25TZWMpKTtcclxuXHJcbiAgICBpZih0eXBlb2YgaW50ZXJ2YWwgIT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsKTtcclxuICAgIH1cclxuICAgIGludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG5cclxuICAgICAgICBjb25zdCBjb21wbGV0ZWRTZWMgPSBwbGF5ZXIuZ2V0Q3VycmVudFRpbWUoKTtcclxuICAgICAgICBjb25zdCBjb21wbGV0ZWRQZXJjZW50ID0gKGNvbXBsZXRlZFNlYy9kdXJhdGlvblNlYykqMTAwO1xyXG5cclxuICAgICAgICAkKFwiLnBsYXllcl9fcGxheWJhY2stYnV0dG9uXCIpLmNzcyh7XHJcbiAgICAgICAgICAgIGxlZnQ6IGAke2NvbXBsZXRlZFBlcmNlbnR9JWBcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJChcIi5wbGF5ZXJfX2R1cmF0aW9uLWNvbXBsZXRlZFwiKS50ZXh0KGZvcm1hdFRpbWUoY29tcGxldGVkU2VjKSk7IFxyXG5cclxuXHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIFxyXG4gICAgfSwgMTAwMCk7XHJcblxyXG59XHJcblxyXG5jb25zdCBvblBsYXllclN0YXRlQ2hhbmdlID0gZXZlbnQgPT4ge1xyXG5cclxuXHJcbiAgICBzd2l0Y2ggKGV2ZW50LmRhdGEpIHtcclxuICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgIHBsYXllckNvbnRhaW5lci5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIHBsYXllckNvbnRhaW5lci5hZGRDbGFzcyhcInBhdXNlZFwiKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgXHJcbiAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICBwbGF5ZXJDb250YWluZXIucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICBwbGF5ZXJDb250YWluZXIucmVtb3ZlQ2xhc3MoXCJwYXVzZWRcIik7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBvbllvdVR1YmVJZnJhbWVBUElSZWFkeSgpIHtcclxuICAgIHBsYXllciA9IG5ldyBZVC5QbGF5ZXIoJ3l0LXBsYXllcicsIHtcclxuICAgICAgICBoZWlnaHQ6ICcxMDAlJyxcclxuICAgICAgICB3aWR0aDogJzEwMCUnLFxyXG4gICAgICAgIHZpZGVvSWQ6ICc3cUJmZGNJLWQxUScsXHJcbiAgICAgICAgZXZlbnRzOiB7XHJcbiAgICAgICAgb25SZWFkeTogb25QbGF5ZXJSZWFkeSxcclxuICAgICAgICBvblN0YXRlQ2hhbmdlOiBvblBsYXllclN0YXRlQ2hhbmdlXHJcbiAgICAgICAgfSwgXHJcbiAgICAgICAgcGxheWVyVmFyczoge1xyXG4gICAgICAgICAgICBjb250cm9sczogMCxcclxuICAgICAgICAgICAgZGlzYWJsZWtiOiAwLFxyXG4gICAgICAgICAgICBzaG93aW5mbzogMCxcclxuICAgICAgICAgICAgcmVsOjAsXHJcbiAgICAgICAgICAgIGF1dG9wbGF5OiAwLFxyXG4gICAgICAgICAgICBtb2Rlc3RicmFuZGluZzowXHJcblxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbmV2ZW50c0luaW50KCk7XHJcblxyXG4iLCI7KGZ1bmN0aW9uKCl7XHJcblxyXG5jb25zdCBmaW5kQmxvY2tCeUFsaWFzID0gKGFsaWFzKSA9PiB7XHJcbiAgICByZXR1cm4gJChcIi5yZXZpZXdzX19pdGVtXCIpLmZpbHRlcigobmR4LCBpdGVtKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuICQoaXRlbSkuYXR0cihcImRhdGEtbGlua2VkLXdpdGhcIikgPT0gYWxpYXM7XHJcbiAgICB9KTtcclxufTtcclxuXHJcblxyXG4kKFwiLmludGVyYWN0aXZlLWF2YXRhcl9fbGlua1wiKS5jbGljayhlPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgY29uc3QgdGFyZ2V0ID0kdGhpcy5hdHRyKFwiZGF0YS1vcGVuXCIpO1xyXG4gICAgY29uc3QgaXRlbVRvU2hvdyA9IGZpbmRCbG9ja0J5QWxpYXModGFyZ2V0KTtcclxuICAgIGNvbnN0IGN1ckl0ZW0gPSAkdGhpcy5jbG9zZXN0KFwiLmludGVyYWN0aXZlLWF2YXRhclwiKTtcclxuICAgIFxyXG5cclxuICAgIGl0ZW1Ub1Nob3cuYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgIGN1ckl0ZW0uYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxufSk7XHJcblxyXG59KSgpIl19
